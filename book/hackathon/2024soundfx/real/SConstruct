from rsf.proj import *

# Fetch & plot dataset
Fetch('elf-stk2.rsf','masha')
Flow('elf','elf-stk2','dd form=native | put unit1=s')
Result('elf','grey')

# Decimate
Flow('decimated','elf','window j2=4 | put d2=53.3333')
Result('decimated','grey')

#Result('original_n_decimated',['elf','decimated'],'SideBySideAniso')

# Zoom-in
Flow('original_w','elf','window max1=1.5 n2=600 | costaper nw1=40')
Flow('decimated_w','decimated','window max1=1.5 n2=150 | costaper nw1=40')
Result('original_w','grey title="Original data"')
Result('decimated_w','grey title="Decimated data"')

#Result('original_n_decimated_w',['elf_w','decimated_w'],'SideBySideAniso')

# T-X interpolation
Flow(['pad_w','mask_w'],'decimated_w','lpad jump=4 mask=${TARGETS[1]}')
Flow(['pef_w','lag_w'],'decimated_w','lpef lag=${TARGETS[1]} a=17,5 jump=4')
Flow('interpolated_w',['pad_w','mask_w','pef_w'],
     'miss padin=4 filt=${SOURCES[2]} mask=${SOURCES[1]} prec=n')
Result('interpolated_w','grey')

Flow('pef_aw','pad_w','apef a=15,4 jump=4 rect1=20 rect2=5 niter=200 verb=y')
Flow('interpolated_aw',['pad_w','pef_aw','mask_w'],'miss4 filt=${SOURCES[1]} mask=${SOURCES[2]} verb=y')
Result('interpolated_aw','grey')

## Interpolation error

# F-X interpolation

## Interpolation error

End()
