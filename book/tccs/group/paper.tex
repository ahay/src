\published{Geophysical Prospecting, v. 52, 247-259 (2004)}
\title{On anelliptic approximations for $qP$ velocities in
transversally isotropic media}

\email{sergey.fomel@beg.utexas.edu}
\author{Sergey Fomel}

\maketitle

\begin{abstract}
I develop a unified approach for approximating phase and group
  velocities of $qP$ seismic waves in a transversally isotropic medium
  with the vertical axis of symmetry (VTI). While the exact phase
  velocity expressions involve four independent parameters to
  characterize the elastic medium, the proposed approximate
  expressions use only three parameters. This makes them more
  convenient for use in surface seismic experiments, where estimation
  of all the four parameters is problematic. The three-parameter
  phase-velocity approximation coincides with the previously published
  ``acoustic'' approximation of Alkhalifah. The group velocity
  approximation is `new and noticeably more accurate than some of the
  previously published approximations. I demonstrate an application of
  the group velocity approximation for finite-difference computation
  of traveltimes.
\end{abstract}

\section{Introduction}

Anellipticity (deviation from ellipse) is an important characteristic of
elastic wave propagation. One of the simplest and yet practically important
cases \new{of anellipticity occurs} in transversally isotropic media with
the vertical axis of symmetry (VTI). In this type of media, the phase
velocities of $qSH$ waves and the corresponding wavefronts are elliptic, while
the phase and group velocities of $qP$ and $qSV$ waves may exhibit strong
anellipticity \cite[]{tsvankin}.

The exact expressions for the phase velocities of $qP$ and $qSV$ waves in VTI
media involve four independent parameters. However, it has been observed that
only three parameters influence wave propagation 
% at small angles from the vertical axis 
and are of interest to surface seismic methods
\cite[]{GEO60-05-15501566}. Moreover, the exact expressions for the group
velocities in terms of the group angle are difficult to obtain and too
cumbersome for practical use. This explains the need for developing practical
three-parameter approximations for both group and phase velocities in VTI
media.

Numerous different successful approximations have been previously developed
\cite[]{GEO54-12-15641574,jse,GEO60-05-15501566,GEO63-02-06230631,GEO65-04-13161325,GEO65-03-09190933,ANI00-00-03490361,SEG-2001-01060109}.
In this paper, I attempt to construct a unified approach for deriving
anelliptic approximations.

The starting point is the anelliptic approximation of Muir
\cite[]{Muir.sep.44.55,jse}. Although not the most accurate for immediate
practical use, this approximation possesses remarkable theoretical properties.
The Muir approximation correctly captures the linear part of anelliptic
behavior. It can be applied to find more accurate approximations with
nonlinear dependence on the anelliptic parameter. A particular way of
``unlinearizing'' the linear approximation is the shifted hyperbola approach,
familiar from the isotropic approximations in vertically inhomogeneous media
\cite[]{malov,Sword.sep.51.313,GEO53-02-01430157,GEO59-06-09830999} and from the
theory of Stolt stretch \cite[]{GEO43-01-00230048,mystolt}. I show that applying
this idea to approximate the phase velocity of $qP$ waves leads to the known
``acoustic'' approximation of \cite{GEO63-02-06230631,GEO65-04-12391250},
derived in a different way.  Applying the same approach to approximate the
group velocity of $qP$ waves leads to a new remarkably accurate
three-parameter approximation.

One practical use for the group velocity approximation is traveltime
computations, required for Kirchhoff imaging and tomography. In the last part
of the paper, I show examples of finite-difference traveltime computations
utilizing the new approximation.

\section{Exact expressions}

Wavefront propagation in the general anisotropic media can be
described with the anisotropic eikonal equation
\begin{equation}
  \label{eq:eikonal}
  v^2\left(\frac{\nabla T}{|\nabla T|},\mathbf{x}\right)\,|\nabla T|^2 = 
  1\;,
\end{equation}
where $\mathbf{x}$ is a point in space, \new{$T(\mathbf{x})$} is the
traveltime \new{at that point for} a given source, and
$v(\mathbf{n},\mathbf{x})$ is the \emph{phase velocity} in the phase direction
$\mathbf{n} = \frac{\nabla T}{|\nabla T|}$.

In the case of VTI media, the three modes of elastic wave propagation
($qSH$, $qSV$, and $qP$) have the following well-known explicit
expressions for the phase velocities \cite[]{gassmann}:
\begin{eqnarray}
  \label{eq:qsh}
  v_{SH}^2(\mathbf{n},\mathbf{x}) & = & 
  m\,\sin^2{\theta} + l\,\cos^2{\theta}\;; \\
  \nonumber
  v^2_{SV}(\mathbf{n},\mathbf{x}) & = &
  \frac{1}{2}\,\left[(a+l)\,\sin^2{\theta} + (c+l)\,\cos^2{\theta}\right] -  \\
  & & \frac{1}{2}\,\sqrt{\left[(a-l)\,\sin^2{\theta} - 
      (c-l)\,\cos^2{\theta}\right]^2 +
      4\,(f+l)^2\,\sin^2{\theta}\,\cos^2{\theta}}\;; 
  \label{eq:qsv} \\
  \nonumber
  v^2_{P}(\mathbf{n},\mathbf{x}) & = &
  \frac{1}{2}\,\left[(a+l)\,\sin^2{\theta} + (c+l)\,\cos^2{\theta}\right] +  \\
  & & \frac{1}{2}\,\sqrt{\left[(a-l)\,\sin^2{\theta} - (c-l)\,\cos^2{\theta}\right]^2 +
      4\,(f+l)^2\,\sin^2{\theta}\,\cos^2{\theta}}\;,
    \label{eq:qp}
\end{eqnarray}
where, in the notation of \cite{backus} and \cite{GEO44-05-08960917},
$a=c_{11}$, $c=c_{33}$, $f=c_{13}$, $l=c_{55}$, $m=c_{66}$, $c_{ij}(\mathbf{x})$
are the density-normalized components of the elastic tensor, and $\theta$ is
the phase angle between the phase direction $\mathbf{n}$ and the axis of
symmetry.
  
The group velocity describes the propagation of individual ray trajectories
$\mathbf{x}(\tau)$.  It can be determined from the phase velocity using the
general expression
\begin{equation}
  \mathbf{V} = \frac{d \mathbf{x}}{d \tau} =
  v \mathbf{n} + \left(\mathbf{I} - \mathbf{n}\, \mathbf{n}^T\right) 
  \nabla_{\mathbf{n}} v\;,
  \label{eq:group}
\end{equation}
where $\mathbf{I}$ denotes the identity matrix, $\mathbf{n}^T$ stands for the
transpose of $\mathbf{n}$, \new{and $\nabla_{\mathbf{n}} v$ is the gradient
  of $v$ with respect to $\mathbf{n}$}. The two terms in
equation~(\ref{eq:group}) are clearly orthogonal to each other. Therefore, the
group velocity magnitude is
\cite[]{GEO20-04-07800806,GEO44-05-08960917,GEO49-11-19081914}
\begin{equation}
  \label{eq:f}
  V = |\mathbf{V}| = \sqrt{v^2 + v_{\theta}^2}\;,
\end{equation}
where 
\begin{equation}
  \label{eq:falpha}
  v_{\theta}^2 =  \left|\left(\mathbf{I} - \mathbf{n}\,
      \mathbf{n}^T\right) \nabla_{\mathbf{n}} v\right|^2 =
  \left|\nabla_{\mathbf{n}} v\right|^2 - 
  \left|\mathbf{n} \cdot \nabla_{\mathbf{n}} v\right|^2\;.
\end{equation}

The group velocity has a particularly simple form in the case of elliptic
anisotropy. \new{Specifically}, the phase velocity squared \new{has} the
quadratic form
\begin{equation}
  \label{eq:ellips}
  v_{\mbox{ell}}^2(\mathbf{n},\mathbf{x}) = 
  \mathbf{n}^T\,\mathbf{A}(\mathbf{x})\,\mathbf{n}
\end{equation}
with a symmetric positive-definite matrix $\mathbf{A}$, and the group
velocity is 
\begin{equation}
  \label{eq:ellf}
  \mathbf{V}_{\mbox{ell}} = \mathbf{A}\,\mathbf{p}\;, 
\end{equation}
where $\mathbf{p} = \nabla T = \mathbf{n}/v(\mathbf{n},\mathbf{x})$.
The corresponding group slowness squared has the explicit expression
\begin{equation}
  \label{eq:ellv}
  \frac{1}{V_{\mbox{ell}}^2(\mathbf{N},\mathbf{x})} = 
    \mathbf{N}^T\,\mathbf{A}^{-1}(\mathbf{x})\,\mathbf{N}\;, 
\end{equation}
where $\mathbf{N}$ is the group direction, and $\mathbf{A}^{-1}$ is the matrix
inverse of $\mathbf{A}$. For example, the elliptic expression~(\ref{eq:qsh}) for
the phase velocity of $qSH$ waves in VTI media transforms into a completely
analogous expression for the group slowness
\begin{equation}
  \label{eq:ellsh}
  \frac{1}{V_{SH}^2(\mathbf{N},\mathbf{x})}  = 
  M\,\sin^2{\Theta} + L\,\cos^2{\Theta}
\end{equation}
where $M=1/m$, $L=1/l$, and $\Theta$ is the angle between the group direction
$\mathbf{N}$ and the axis of symmetry.

\inputdir{Sage}

The situation is more complicated in the anelliptic case.
Figure~\ref{fig:exph} shows the $qP$ and $qSV$ phase velocity profiles in a
transversely isotropic material -- Greenhorn shale \cite[]{GEO46-03-02880297},
which has the parameters $a=14.47\,\mbox{km}^2/\mbox{s}^2$,
$l=2.28\,\mbox{km}^2/\mbox{s}^2$, $c=9.57\,\mbox{km}^2/\mbox{s}^2$, and
$f=4.51\,\mbox{km}^2/\mbox{s}^2$. Figure~\ref{fig:exgr} shows the
corresponding group velocity profiles. The non-convexity of the $qSV$ phase
velocity causes a multi-valued (triplicated) group velocity profile. The
shapes of all the surfaces are clearly anelliptic.


\plot{exph}{height=3in}{Phase velocity profiles for $qP$ (outer curve) and
  $qSV$ (inner curve) waves in a transversely isotropic material (Greenhorn
  shale).}

\plot{exgr}{height=3in}{Group velocity profiles for $qP$ (outer curve) and
  $qSV$ (inner curve) waves in a transversely isotropic material (Greenhorn
  shale).}

A simple model of anellipticity is suggested by the Muir approximation
\cite[]{Muir.sep.44.55,jse}, reviewed in the next section.

\section{Muir approximation}

\cite{Muir.sep.44.55} suggested representing anelliptic $qP$ phase
velocities with the following approximation:
\begin{equation}
\label{eq:muph}
  v_P^2(\theta) \approx e(\theta) + 
\frac{(q-1)\,a\,c\,
\sin^2{\theta}\,\cos^2{\theta}}{e(\theta)}
\;,
\end{equation}
where $e(\theta)$ is the elliptical part of the velocity, defined by
\begin{equation}
\label{eq:muel}
e(\theta) = a\,\sin^2{\theta} + c\,\cos^2{\theta}\;,
\end{equation}
and $q$ is the anellipticity coefficient ($q=1$ in case of elliptic
velocities). Approximation~(\ref{eq:muph}) uses only three parameters to
characterize the medium ($a$, $c$, and $q$) as opposed to the four parameters
($a$, $c$, $l$, and $f$) in the exact expression.

There is some freedom in choosing an appropriate value for the coefficient
$q$. Assuming near-vertical wave propagation and the vertical axis of symmetry
(a VTI medium) and fitting the curvature ($d^2 v_P/d \theta^2$) of the exact
phase velocity~\eqref{eq:qp} near the vertical phase angle ($\theta = 0$),
leads to the definition \cite[]{jse}
\begin{equation}
  \label{eq:qpdef}
  q = \frac{l\,(c-l) + (l+f)^2}
  {a\,(c-l)}\;.
\end{equation}
In terms of Thomsen's elastic parameters $\epsilon$ and $\delta$
\cite[]{GEO51-10-19541966} and the elastic parameter $\eta$ of
\cite{GEO60-05-15501566},
\begin{equation}
  \label{eq:eta2q}
  q = \frac{1 + 2\,\delta}{1 + 2\epsilon}
= \frac{1}{1 + 2\,\eta}\;.
\end{equation}
This confirms the direct relationship between $\eta$ and anellipticity.  If we
were to fit the phase velocity curvature near the horizontal axis
$\theta=\pi/2$ (perpendicular to the axis of symmetry), the appropriate value
for $q$ would be
\begin{equation}
  \label{eq:qpdefhat}
  \hat{q} = \frac{l\,(a-l) + (l+f)^2}
  {c\,(a-l)}\;.
\end{equation}

\cite{Muir.sep.44.55} also suggested approximating the VTI
group velocity with an analogous expression
\begin{equation}
  \label{eq:muir2}
\frac{1}{V^2_{P}(\Theta)} \approx E(\Theta) + 
\frac{(Q-1)\,A\,C\,
\sin^2{\Theta}\,\cos^2{\Theta}}{E(\Theta)}
\end{equation}
where $A=1/a$, $C=1/c$, $Q = 1/q$, $\Theta$ is the group angle, and
$E(\Theta)$ is the elliptical part:
\begin{equation}
\label{eq:muel2}
E(\Theta) = A\,\sin^2{\Theta} + C\,\cos^2{\Theta}\;.
\end{equation}
Equations~\eqref{eq:muph} and~\eqref{eq:muir2} are consistent in the sense
that both of them are exact for elliptic anisotropy ($q=Q=1$) and
accurate to the first order in $(q-1)$ or $(Q-1)$ in the general case of
transversally isotropic media.

To the same approximation order, the connection between the phase and group
directions is
\begin{equation}
\label{eq:t2T}
\tan{\Theta}  = \tan{\theta}\,\frac{a}{c}\, 
\left(1 - (q-1)\,\frac
  {a\,\sin^2{\theta} - c\,\cos^2{\theta}}
  {a\,\sin^2{\theta} + c\,\cos^2{\theta}}\right)\;.
\end{equation}
%or
%\begin{equation}
%  \label{eq:T2t}
%  \sin^2{\theta}  =  
%  \frac{A^2\,\sin^2{\Theta}}{\left(A^2\,\sin^2{\Theta} + 
%      C^2\,\cos^2{\Theta}\right)}\,
%  \left[1 - \frac{2\,(Q-1)\,C^2\,\cos^2{\Theta}\,
%      \left(C\,\cos^2{\Theta} - A\,\sin^2{\Theta}\right)}
%    {\left(A\,\sin^2{\Theta} + C\,\cos^2{\Theta}\right)\,
%      \left(A^2\,\sin^2{\Theta} + C^2\,\cos^2{\Theta}\right)}\right]\;.
%\end{equation}

\section{Shifted hyperbola approximation for the phase velocity}

Despite the beautiful symmetry of Muir's approximations~(\ref{eq:muph})
and~(\ref{eq:muir2}), they are less accurate in practice than some other
approximations, most notably the weak anisotropy approximation of
\cite{GEO51-10-19541966}, which can be written as 
\cite[]{GEO61-02-04670483}
\begin{equation}
  \label{eq:thoms}
  v_P^2(\theta) \approx c\,\left(1 + 2\,\epsilon\,\sin^4{\theta} + 
  2\,\delta\,\sin^2{\theta}\,\cos^2{\theta}\right)\;,
\end{equation}
where 
\begin{equation}
  \label{eq:epsdelta}
  \epsilon = \frac{a-c}{2\,c}\quad\mbox{and}\quad
  \delta = \frac{(l + f)^2 - (c - l)^2}{2\,c\,(c - l)}\;.
\end{equation}

Note that both approximations involve the anellipticity factor ($q-1$ or
$\epsilon-\delta$) in a linear fashion. If the anellipticity effect is
significant, the accuracy \new{of Muir's equations can be improved by
replacing the linear approximation with a nonlinear one}. There are, of
course, infinitely many nonlinear expressions that share the same
linearization. In this study, I focus on the shifted hyperbola approximation,
which follows from the fact that an expression of the form
 \begin{equation}
   \label{eq:lin}
   x + \frac{\alpha}{x}   
 \end{equation}
is the linearization (Taylor series expansion) of the form
\begin{equation}
  \label{eq:nonlin}
  x\,(1-s) + s\,\sqrt{x^2 + \frac{2\,\alpha}{s}}
\end{equation}
for small $\alpha$. Linearization does not depend on the parameter $s$, which
affects only higher-order terms in the Taylor expansion.
Expression~(\ref{eq:nonlin}) is reminiscent of the shifted hyperbola
approximation for normal moveout in vertically heterogeneous media
\cite[]{malov,Sword.sep.51.313,GEO53-02-01430157,GEO59-06-09830999} and the
Stolt stretch correction in the frequency-wavenumber migration
\cite[]{GEO43-01-00230048,mystolt}. It is evident that Muir's
approximation~(\ref{eq:muph}) has exactly the right form~(\ref{eq:lin}) to be
converted to the shifted hyperbola approximation~(\ref{eq:nonlin}). 

Thus, we seek an approximation of the form
\begin{equation}
  \label{eq:shiftm}
  v_P^2(\theta) \approx e(\theta)\,(1-s) + s\,\sqrt{e^2(\theta) + 
    \frac{2\,(q-1)\,a\,c\,
      \sin^2{\theta}\,\cos^2{\theta}}{s}}
\end{equation}
with $e(\theta)$ defined by equation~(\ref{eq:muel}). The plan is to select a
value of the additional parameter $s$ to fit the exact phase velocity
expression~(\ref{eq:qp}) and then to constrain $s$ so that it depends only on
the three parameters already present in the original
approximation~\eqref{eq:muph}.

One can verify that the velocity curvature $d^2 v_P/d \theta^2$ around the
vertical axis $\theta=0$ for approximation~(\ref{eq:shiftm}) depends on the
chosen value of $q$ but does not depend on the value of the shift parameter
$s$. This means that the velocity profile $v_P(\theta)$ becomes sensitive to
$s$ only further away from the vertical direction.  This separation of
influence between the approximation parameters is an important and attractive
property of the shifted hyperbola approximation. I find an appropriate value
for $s$ by fitting additionally the fourth-order derivative $d^4 v_P/d
\theta^4$ at $\theta=0$ to the corresponding derivative of the exact
expression. The fit is achieved when $s$ has the value
\begin{equation}
  \label{eq:sval}
  s = \frac{c-l}{2}\,\frac{(a-l)\,(c-l) - (l+f)^2}
  {a\,(c-l)^2 - c\,(l+f)^2}\;.  
\end{equation}
It is more instructive to express it in the form
\begin{equation}
  \label{eq:sval2}
  s = \frac{1}{2}\,\frac{(a-c)\,(q-1)\,(\hat{q}-1)}
  {a\,\left(1 - \hat{q} - q\,(1-q)\right) - 
    c\,\left((\hat{q}-1)^2+\hat{q}\,(q-\hat{q})\right)}\;,  
\end{equation}
where $q$ and $\hat{q}$ are defined by equations~\eqref{eq:qpdef}
and~\eqref{eq:qpdefhat}.  In this form of the expression, $\hat{q}$ appears as
the extra parameter that we need to eliminate.  This parameter was defined by
fitting the velocity profile curvature around the horizontal axis, which would
correspond to infinitely large offsets in a surface seismic experiment. One
possible way to constrain it is to set $\hat{q}$ equal to $q$, which implies
that the velocity profile has similar behavior near the vertical and the
horizontal axes. Setting $\hat{q} \approx q$ in equation~\eqref{eq:sval2}
yields
\begin{equation}
  \label{eq:sappr}
  s \approx \lim_{\hat{q} \rightarrow q} s = \frac{1}{2}\;.
\end{equation}
Substituting \eqref{eq:sappr} in equation~\eqref{eq:shiftm} produces the final
approximation
\begin{equation}
  \label{eq:shiftm2}
  v_P^2(\theta) \approx \frac{1}{2}\,e(\theta) + 
  \frac{1}{2}\,\sqrt{e^2(\theta) + 
    4\,(q-1)\,a\,c\,\sin^2{\theta}\,\cos^2{\theta}}\;.
\end{equation}

Approximation~\eqref{eq:shiftm2} is exactly equivalent to the \emph{acoustic
  approximation} of \cite{GEO63-02-06230631,GEO65-04-12391250},
derived with a different set of parameters by formally setting the $S$-wave
velocity ($l=v_S^2$) in equation~(\ref{eq:qp}) to zero. A similar
  approximation is analyzed by \cite{ANI00-00-03490361}.
Approximation~\eqref{eq:shiftm2} was proved to possess a remarkable accuracy
even for large phase angles and significant amounts of anisotropy.
Figure~\ref{fig:errphp} compares the accuracy of different approximations using
the parameters of the Greenhorn shale. The acoustic approximation appears
especially accurate for phase angles up to about 25 degrees and does not
exceed the relative error of 0.3\% even for larger angles.

\plot{errphp}{height=3in}{Relative error of different phase velocity
  approximations for the Greenhorn shale anisotropy. Short dash: Thomsen's
  weak anisotropy approximation. Long dash: Muir's approximation. Solid line:
  suggested approximation (similar to Alkhalifah's acoustic approximation.)}

\section{Shifted hyperbola approximation for the group velocity}
\inputdir{Math}

Similar strategy is applicable for approximating the group velocity. Applying
the shifted hyperbola approach to ``unlinearize'' Muir's
approximation~(\ref{eq:muir2}), we seek an approximation of the form
\begin{equation}
  \label{eq:shiftM}
  \frac{1}{V_P^2(\Theta)} \approx E(\Theta)\,(1-S) + S\,\sqrt{E^2(\Theta) + 
    \frac{2\,(Q-1)\,A\,C\,
      \sin^2{\Theta}\,\cos^2{\Theta}}{S}}
\end{equation}
An approximation of this form with $S$ set to $1/2$ was proposed earlier by
\cite{SEG-2001-01060109}. Similarly to the case of the phase velocity
approximation, I constrain the value of $S$ by Taylor fitting of the velocity
profiles near the vertical angle.

Although there is no simple explicit expression for the transversally
isotropic group velocity, we can differentiate the parametric representations
of $V_P$ and $\Theta$ in terms of the phase angle $\theta$ that follow from
equation~(\ref{eq:group}). The group velocity is an even function of the angle
$\Theta$ because of the VTI symmetry. Therefore, the odd-order derivatives are
zero at the axis of symmetry ($\Theta=\theta=0$). Fitting the second-order
derivative $d^2 V_P/d\Theta^2$ at $\theta=0$ produces $Q=1/q=1+2\,\eta$,
consistent with Muir's approximation~(\ref{eq:muir2}). Fitting additionally
the fourth-order derivative $d^4 V_P/d\Theta^4$ at $\theta=0$ produces
\begin{equation}
  \label{eq:Sval}
  S = \frac{1}{2}\,\frac{
    \left[(l+f)^2 + l\,(c-l)\right]^2\,\left[(c-l)\,(a-l) - (l+f)^2\right]}{
    a^2\,c\,(c-l)\,(l+f)^2 - \left[l\,(c-l) + (l+f)^2\right]^3}
\end{equation}
or, equivalently,
\begin{equation}
  \label{eq:Sval2}
  S = \frac{1}{2}\,\frac{(C-A)\,(Q-1)\,(\hat{Q}-1)}
  {C\,\left(\hat{Q}\,(Q^2-Q-1) + 1\right) + 
    A\,\left(\hat{Q}-Q^3+Q^2-1\right)}\;,
\end{equation}
where $\hat{Q}=1/\hat{q}$. \new{As in} the
previous section, I approximate the optimal value of $S$ by setting $\hat{Q}$
equal to $Q$, as follows:
\begin{equation}
  \label{eq:Sappr}
  S \approx \lim_{\hat{Q} \rightarrow Q} S = \frac{1}{2\,(1+Q)} = 
  \frac{1}{4\,(1 + \eta)}\;.
\end{equation}
Selected in this way, the value of $S$ depends on the anelliptic parameter $Q$
(or $\eta$) and, for small anellipticity, is close to $1/4$, which is
different from the value of $1/2$ in the approximation of
\cite{SEG-2001-01060109}.

The final group velocity approximation takes the form
\begin{equation}
  \label{eq:shiftM2}
  \frac{1}{V^2_{P}(\Theta)} \approx \frac{1+2\,Q}{2\,(1+Q)}\,E(\Theta) + 
\frac{1}{2\,(1+Q)}\,
\sqrt{E^2(\Theta) + 4\,(Q^2-1)\,A\,C\,\sin^2{\Theta}\,\cos^2{\Theta}}\;.
\end{equation}
In Figure~\ref{fig:errgrp}, the accuracy of approximation~(\ref{eq:shiftM2})
is compared with the accuracy of Muir's approximation~(\ref{eq:muir2}) and the
accuracy of the weak anisotropy approximation \cite[]{GEO51-10-19541966} for the
elastic parameters of the Greenhorn shale. The weak anisotropy approximation,
used in this comparison, is
\begin{equation}
  \label{eq:thoms2}
  V_P^2(\Theta) \approx c\,\left(1 + 2\,\epsilon\,\sin^4{\Theta} + 
    2\,\delta\,\sin^2{\Theta}\,\cos^2{\Theta}\right)\;,
\end{equation}
where $\epsilon$ and $\delta$ are Thomsen's parameters, defined in
equations~(\ref{eq:epsdelta}). A similar form (in a different
parameterization) was introduced by \cite{GEO54-12-15641574}.

Approximation~(\ref{eq:shiftM2}) turns out to be remarkably accurate
\new{for} this example. It appears nearly exact for group angles up to 45
degrees from vertical and does not exceed 0.3\% relative error even at
\new{larger} angles. It is compared with two other approximations in
Figure~\ref{fig:errgrp2}. These are the Zhang-Uren approximation
\cite[]{SEG-2001-01060109} and the Alkhalifah-Tsvankin approximation, which
follows directly from the normal moveout equation suggested by
\cite{GEO60-05-15501566}:
\begin{equation}
  \label{eq:talts}
  t^2(x) \approx t_0^2 + \frac{x^2}{V_n^2} - 
  \frac{2\,\eta\,x^4}{V_n^2\,\left[t_0^2\,V_n^2 + (1+ 2\,\eta)\,x^2\right]}
\;,
\end{equation}
where $t(x)$ is the moveout curve, $t_0$ is the vertical traveltime, and $V_n
= \sqrt{a/(1 + 2\,\eta)}$ is the NMO velocity. In a homogeneous medium,
equation~(\ref{eq:talts}) corresponds to the group velocity approximation
\begin{equation}
  \label{eq:valts}
  \frac{1}{V_P^2(\Theta)} \approx \frac{\cos^2{\Theta}}{V_z^2} + 
  \frac{\sin^2{\Theta}}
  {V_n^2} - \frac{2\,\eta\,\sin^4{\Theta}}
  {V_n^2\,\left[\cos^2{\Theta}\,V_n^2/V_z^2 + 
  (1+ 2\,\eta)\,\sin^2{\Theta}\right]}
\;,
\end{equation}
where $V_z = \sqrt{c}$. In the notation of this paper, the Alkhalifah-Tsvankin
equation~(\ref{eq:valts}) takes the form
\begin{equation}
  \label{eq:valts2}
  \frac{1}{V_P^2(\Theta)} \approx E(\Theta) + 
  \frac{(Q-1)\,A\,C\,
    \sin^2{\Theta}\,\cos^2{\Theta}}{E(\Theta) + (Q^2-1)\,A\,\sin^2{\Theta}}
\end{equation}
and differs from approximation~(\ref{eq:muir2}) by the correction term in the
denominator. Approximation~(\ref{eq:shiftM2}) is noticeably more accurate
\new{for} this example than any of the other approximations considered here.

\new{Another accurate group velocity approximation was suggested by}
\cite{GEO65-04-13161325}. \new{However, the analytical expression is
complicated and inconvenient for practical use. The accuracy of Alkhalifah's
approximation for the Greenhorn shale example is depicted in}
Figure~\ref{fig:errgrp4}.

\plot{errgrp}{height=3in}{Relative error of different group velocity
  approximations for the Greenhorn shale anisotropy. Short dash: Thomsen's
  weak anisotropy approximation. Long dash: Muir's approximation. Solid line:
  suggested approximation.}

\plot{errgrp2}{height=3in}{Relative error of different group velocity
  approximations for the Greenhorn shale anisotropy. Short dash:
  Alkhalifah-Tsvankin approximation. Long dash: Zhang-Uren 
  approximation. Solid line: suggested approximation.}

\plot{errgrp4}{height=3in}{Relative error of different group velocity
  approximations for the Greenhorn shale anisotropy. Dashed line:
  Alkhalifah approximation. Solid line: suggested approximation.}

It is similarly possible to convert a group velocity approximation into the
corresponding moveout equation. In a homogeneous anisotropic medium, the
reflection traveltime $t$ as a function of offset $x$ is
\begin{equation}
  \label{eq:travel}
  t(x) = \frac{2\,\sqrt{(x/2)^2+z^2}}
  {V_P\left(\arctan\left(\frac{x}{2\,z}\right)\right)}\;,
\end{equation}
where $z = t_0\,V_P(0)/2$ is the depth of the reflector.  The moveout equation
corresponding to approximation~(\ref{eq:shiftM2}) is
\begin{eqnarray}
  \nonumber
  t^2(x) & \approx & \frac{1+2\,Q}{2\,(1+Q)}\,H(x) + 
\frac{1}{2\,(1+Q)}\,
\sqrt{H^2(x) + 4\,(Q^2-1)\,\frac{t_0^2\,x^2}{Q\,V_n^2}} \\
& = & \frac{3+4\,\eta}{4\,(1+\eta)}\,H(x) + 
\frac{1}{4\,(1+\eta)}\,
\sqrt{H^2(x) + 16\,\eta\,(1+\eta)\,\frac{t_0^2\,x^2}{(1+2\,\eta)\,V_n^2}}
\;,
  \label{eq:moveout}
\end{eqnarray}
where
$H(x)$ represents the hyperbolic part:
\begin{equation}
  \label{eq:hyper}
  H(x) = t_0^2 + \frac{x^2}{Q\,V_n^2} = 
  t_0^2 + \frac{x^2}{(1+2\,\eta)\,V_n^2}\;.
\end{equation}
For small offsets, the Taylor series expansion of equation~(\ref{eq:moveout})
is
\begin{eqnarray}
\nonumber
t^2(x) & \approx & t_0^2 + \frac{x^2}{V_n^2} - 
(Q-1)\,\frac{x^4}{t_0^2\,V_n^4} +
(Q-1)\,(2\,Q^2-1)\,\frac{x^6}{Q\,t_0^4\,V_n^6} + O(x^8) \\
& = & t_0^2 + \frac{x^2}{V_n^2} - 2\,\eta\,\frac{x^4}{t_0^2\,V_n^4} +
2\,\eta\,(1+8\,\eta+8\eta^2)\,\frac{x^6}{(1+2\,\eta)\,t_0^4\,V_n^6} + 
O(x^8)\;.
\label{eq:moveout2}  
\end{eqnarray}

Figure~\ref{fig:timepp} compares the accuracy of different moveout
approximations assuming reflection from the bottom of a homogeneous
anisotropic layer of 1~km thickness with the elastic parameters of Greenhorn
shale.  Approximation~(\ref{eq:moveout}) appears extremely accurate for
half-offsets up to 1~km and does not develop errors greater than 5~ms even
at much larger offsets.
  
\plot{timepp}{height=3in}{Traveltime moveout error of different group velocity
  approximations for Greenhorn shale anisotropy. The reflector depth is 1~km.
  Short dash: Alkhalifah-Tsvankin approximation. Long dash: Zhang-Uren
  approximation. Solid line: suggested approximation.}

It remains to be seen if the suggested approximation proves to be useful for
describing normal moveout in layered media. The next section discusses its
application for traveltime computation in heterogenous velocity models.

\section{Application: Finite-difference traveltime computation}

\new{As} an essential part of seismic imaging with the Kirchhoff method,
traveltime computation has received a lot of attention in the geophysical
literature.  Finite-difference eikonal solvers
\cite[]{GEO55-05-05210526,GEO56-06-08120821,podvin.gji.91} provide an efficient
and convenient way of computing first arrival traveltimes on regular grids.
Although they have a limited capacity for imaging complex structures
\cite[]{GEO58-04-05640575}, eikonal solvers can be extended in several different
ways to accommodate multiple arrivals
\cite[]{GEO62-02-05770588,SEG-1998-1945,GEO64-01-02300239}. A particularly
attractive approach to finite-difference traveltime computation is the fast
marching method, developed by \cite{paper} in the general context of level
set methods for propagating interfaces \cite[]{osher,book}.
\cite{GEO64-02-05160523} adopt the fast marching method for computing
seismic isotropic traveltimes. Alternative implementations are discussed by
\cite{SEG-1998-1949}, \cite{GPR49-02-01650178}, and \cite{kim}.
The fast marching method possesses a remarkable numerical stability, which
results from a cleverly chosen order of finite-difference evaluation.  The
order selection scheme resembles expanding wavefronts of
\cite{GEO57-03-04780487} and wavefront tracking of
\cite{GEO59-04-06320643}.

While the anisotropic eikonal equation~(\ref{eq:eikonal}) operates with phase
velocities, the kernel of the fast marching eikonal solver can be interpreted
in terms of local ray tracing in a constant-velocity background
\cite[]{Fomel.sep.95.sergey3} and is more conveniently formulated with the help
of the group velocity. \cite{alex} present a thorough extention of the
fast marching method to anisotropic wavefront propagation in the form of
ordered upwind methods. In this paper, I adopt a simplified approach.
Anisotropic traveltimes are computed in relation to an isotropic background.
At each step of the isotropic fast marching method, the local propagation
direction is identified, and the anisotropic traveltimes are computed by local
ray tracing with the group velocity corresponding to the same direction.  This
is analogous to the tomographic linearization approach in ray tracing, where
anisotropic traveltimes are computed along ray trajectories, traced in the
isotropic background \cite[]{pratt}. \cite{tariq} and \cite{schneider}
present different approaches for linearizing the anisotropic eikonal equation.

Many alternative forms of finite-difference traveltime computation in
anisotropic media are presented in the literature
\cite[]{GEO58-09-13491358,SEG-1997-1786,SEG-1999-18751878,ANI00-00-03330338,SEG-2001-12251228,qin,linbin}.
Although the method of this paper has limited accuracy because of the
linearization assumption, it is simple and efficient in practice and serves as
an illustration for the advantages of the explicit group velocity
approximation~(\ref{eq:shiftM2}).  For a more accurate and robust extension of
the fast marching method for anisotropic traveltime calculation, I recommend
the ordered upwind methods of \cite{alex,alex2}.

\inputdir{ell}

Figure~\ref{fig:const} shows finite-difference wavefronts for an isotropic and
an anisotropic homogeneous media, compared with the exact solutions. The
anisotropic media has the parameters of the Greenhorn shale. The
finite-difference error decreases with finer sampling.

\plot{const}{height=2.5in}{Finite-difference wavefronts in an isotropic (left)
  and an anisotropic (right) homogeneous media. The anisotropic media has the
  parameters of the Greenhorn shale. The finite-difference sampling is 100~m.
  The contour sampling is 0.1~s. Dashed curves indicate the exact solution.
  The finite-difference error will be reduced at finer sampling.}

\inputdir{emarm}

Figure~\ref{fig:marm} shows the first arrival wavefronts (traveltime contours)
computed in the ani\-so\-tro\-pic Marmousi model created by
\cite{Alkhalifah.sep.95.tariq3} in comparison with wavefronts for the
isotropic Marmousi model \cite[]{TLE13-09-09270936,TME00-00-00010194}. The model
parameters are shown in Figure~\ref{fig:marmmod}. The observed significant
difference in the wavefront position suggests a difference in the positioning
of seismic images when anisotropy is not properly taken into account.

\plot{marm}{width=5.5in}{Finite-difference wavefronts in the isotropic
  (top) and anisotropic (bottom) Marmousi models. A significant shift
  in the wavefront position suggest possible positioning error when
  seismic imaging does not take anisotropy into account.}

\plot{marmmod}{width=5.5in}{Alkhalifah's anisotropic Marmousi model.
  Top: vertical velocity. Bottom: anelliptic $\eta$ parameter. The
  vertical velocity is taken equal to the NMO velocity $V_n$.}

\section{Conclusions}

I have developed a general approach for approximating both phase and group
velocities in a VTI medium. Suggested approximations use three elastic
parameters as opposed to the four parameters in the exact phase velocity
expression. The phase velocity approximation coincides with the acoustic
approximation of \cite{GEO63-02-06230631,GEO65-04-12391250} but is derived
differently. The group velocity approximation has an analogous form and
similar superior approximation properties. It is important to stress that the
two approximations do not correspond exactly to each other. The exact group
velocity corresponding to the acoustic approximation is different from the
approximation derived in this paper and can be too complicated for practical
use \cite[]{EAE-1999-1049}. The suggested phase and group approximations match
each other in the sense that they have analogous approximation accuracy in the
dual domains.

The group velocity approximation is useful for approximating normal moveout
and diffraction traveltimes in applications to non-hyperbolic velocity
analysis and prestack time migration. It is also useful for traveltime
computations that require ray tracing in locally homogeneous cells. I have
shown examples of such computations utilizing an anisotropic extension of the
fast marching finite-difference eikonal solver.

%I have found no simple way to extend the results of this paper for
%approximating velocities of $qSV$ waves. Such an extension awaits further
%research.

\section{Acknowledgments}

The paper was improved by helpful suggestions from Tariq Alkhalifah and Paul
Fowler.

\bibliographystyle{seg}
\bibliography{SEG,aniso}

%\APPENDIX{A}

%\plot{name}{width=6in,height=}{caption}
%\sideplot{name}{height=1.5in,width=}{caption}
%
%\begin{equation}
%\label{eqn:}
%\end{equation}
%
%\ref{fig:}
%(\ref{eqn:})
